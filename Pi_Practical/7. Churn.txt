import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler, LabelEncoder
from sklearn.metrics import accuracy_score,confusion_matrix
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense

df=pd.read_csv('Churn_Modelling.csv')

print(df.head())
print(df.info())
print(df.describe())
print(df.columns)
print(df.shape)

x=df.iloc[:,3:13].values
y=df.iloc[:,13].values

le1=LabelEncoder()
x[:,1]=le1.fit_transform(x[:,1])
le2=LabelEncoder()
x[:,2]=le2.fit_transform(x[:,2])

x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.25,random_state=42)

scaler=StandardScaler()
x_train=scaler.fit_transform(x_train)
x_test=scaler.transform(x_test)

model=Sequential()
model.add(Dense(6,activation='relu',input_dim=10))
model.add(Dense(6,activation='relu'))
model.add(Dense(1,activation='sigmoid'))

model.compile(optimizer='adam',loss='binary_crossentropy',metrics=['accuracy'])
model.fit(x_train,y_train,epochs=50,batch_size=32,verbose=0)

y_pred=(model.predict(x_test)>0.5).astype(int)
print('accuracy: ',accuracy_score(y_test,y_pred))
print('confusion matrix:\n ',confusion_matrix(y_test,y_pred))

result=pd.DataFrame({'Predicted':y_pred.flatten(), 'Acutal':y_test})
print(result.head(10))