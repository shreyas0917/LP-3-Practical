import pandas as pd
import matplotlib.pyplot as plt
from sklearn.preprocessing import StandardScaler
from sklearn.cluster import KMeans

df=pd.read_csv("sales_data_sample (1).csv",encoding='latin1')

print(df.head())
print(df.info())
print(df.describe())
print(df.columns)
print(df.shape)

numeric_data=df.select_dtypes(include=['int64','float64'])

print(numeric_data.isnull().sum())

scaler=StandardScaler()
scaled_data=scaler.fit_transform(numeric_data)

wcss=[]
for i in range(1,11):
  kmeans=KMeans(n_clusters=i,random_state=42)
  kmeans.fit(scaled_data)
  wcss.append(kmeans.inertia_)

plt.plot(range(1,11),wcss,marker='o')
plt.title('elbow method')
plt.xlabel('number of clusters')
plt.ylabel('wcss')
plt.show()

kmenas=KMeans(n_clusters=8,random_state=42)
df['cluster']=kmeans.fit_predict(scaled_data)

print(df[['SALES','QUANTITYORDERED','MSRP','cluster']].head())